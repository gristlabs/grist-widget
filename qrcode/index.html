<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>QR Code</title>
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js" integrity="sha512-pUhApVQtLbnpLtJn6DuzDD5o2xtmLJnJ7oBoMsBnzOkVkpqofGLGPaBJ6ayD2zQe3lCgCibhJBi4cj5wAxwVKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  </head>
  <body>
    <canvas id="qr"></canvas>
    <script>
      const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0)
      const vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0)
      const size = .92 * Math.min(vw, vh)
      grist.ready({
        columns: ['QR'],
        requiredAccess: 'read table'
      });
      grist.onRecord(function(record) {
        const { QR } = grist.mapColumnNames(record);
        const qr = new QRious ({
          element: document.getElementById('qr'),
          level: 'M',
          size,
          value: QR
        });
      });
    </script>
  </body>
</html>
